Searched for files matching `**/src/baofeng_logo_flasher/**/*.py`, 20 matches

Searched for regex `if __name__|def main|cli|streamlit|entrypoint|run\(|app.run|if __main__` (`**/src/baofeng_logo_flasher/**/*.py`), 40 results

Searched for text `import ` (`**/src/baofeng_logo_flasher/**/*.py`), 100 results

Searched for regex `def |class |^[A-Z_]+ ?=|^[A-Z_]+:|^\w+ ?=` (`**/src/baofeng_logo_flasher/**/*.py`), 200 results

Searched for text `import |from ` (`**/src/baofeng_logo_flasher/**/*.py`), 200 results

Searched for regex `logo_protocol|LogoProtocol|def |class ` (`**/src/baofeng_logo_flasher/protocol/logo_protocol.py`), 42 results

Searched for regex `logo_protocol|LogoProtocol|upload_logo|LogoUploader` (`**/src/baofeng_logo_flasher/**/*.py`), 35 results

Searched for regex `LogoUploader|logo_upload|logo_protocol|upload_logo` (`**/src/baofeng_logo_flasher/cli.py`), 2 results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/streamlit_ui.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/boot_logo.py`), 5 results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/core/actions.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/protocol/uv5rm_protocol.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/protocol/uv5rm_transport.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/features.py`), 1 result

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/models/registry.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/logo_codec.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/bmp_utils.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/firmware_crypto.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/core/results.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/core/safety.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/core/messages.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/core/parsing.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/core/__init__.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/core/actions.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/core/results.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/core/safety.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/core/messages.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/core/parsing.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/features.py`), 1 result

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/models/registry.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/ui/components.py`), no results

Searched for regex `logo_protocol|LogoUploader|upload_logo|logo_upload` (`**/src/baofeng_logo_flasher/ui/__init__.py`), no results

Read [](file:///Users/xoni/Documents/GitHub/Baofeng_Logo_Flasher/src/baofeng_logo_flasher/protocol/logo_protocol.py#1-1), lines 1 to 60

Read [](file:///Users/xoni/Documents/GitHub/Baofeng_Logo_Flasher/src/baofeng_logo_flasher/protocol/logo_protocol.py#61-61), lines 61 to 180

Read [](file:///Users/xoni/Documents/GitHub/Baofeng_Logo_Flasher/src/baofeng_logo_flasher/protocol/logo_protocol.py#181-181), lines 181 to 688

Read [](file:///Users/xoni/Documents/GitHub/Baofeng_Logo_Flasher/src/baofeng_logo_flasher/protocol/uv5rm_protocol.py#1-1), lines 1 to 60

Read [](file:///Users/xoni/Documents/GitHub/Baofeng_Logo_Flasher/src/baofeng_logo_flasher/protocol/uv5rm_protocol.py#61-61), lines 61 to 180

Read [](file:///Users/xoni/Documents/GitHub/Baofeng_Logo_Flasher/src/baofeng_logo_flasher/protocol/uv5rm_protocol.py#181-181), lines 181 to 491

# Dead/Redundant/Legacy Code Audit

---

## Scope & Entry Points

**Included (Production) Files:**
- All files under baofeng_logo_flasher except for subfolders: tests, tools, and any `*.md` or non-`.py` files.

**Excluded:**
- All `*.md` files, tests, tools, and any other non-runtime or utility scripts.

**Primary Entrypoints:**
- cli.py (CLI via Typer)
- streamlit_ui.py (Streamlit UI)

**Key Runtime Flows:**
- CLI and Streamlit both orchestrate operations via core modules (actions.py, results.py, etc.).
- Protocols for device communication: uv5rm_protocol.py, uv5rm_transport.py, and logo_protocol.py.
- Model registry and feature management: registry.py, features.py.

---

## Definitely Unused (Safe Candidates)

| File | Symbol | Evidence | Risk | Suggested Action |
|------|--------|----------|------|-----------------|
| logo_protocol.py | `LogoUploader` (class) | Not referenced by any included file except for its own module and __init__.py re-export; not used in CLI, Streamlit, or boot_logo.py | LOW | Delete now |
| logo_protocol.py | `upload_logo` (function) | Only used in boot_logo.py (see below); not referenced in CLI, Streamlit, or core flows | LOW | Delete now if boot_logo.py is confirmed obsolete |
| logo_protocol.py | `dump_logo_debug_artifacts` | Not referenced outside its own module | LOW | Delete now if not used for debugging |
| logo_protocol.py | `render_rgb565_payload_row_major` | Not referenced outside its own module | LOW | Delete now if not used for debugging |
| logo_protocol.py | `convert_image_to_rgb565` | Not referenced outside its own module | LOW | Delete now if not used for debugging |

---

## Probably Unused (Dynamic-Use Risk)

| File | Symbol | Evidence | Why dynamic risk | Suggested Verification |
|------|--------|----------|------------------|-----------------------|
| logo_protocol.py | `upload_logo` | Only imported in boot_logo.py as `protocol_upload_logo` | Could be called via dynamic import or reflection in boot_logo.py | Check if boot_logo.py is used as a plugin or via dynamic import anywhere |
| logo_protocol.py | `LogoUploader` | Re-exported in __init__.py | Could be used by external scripts importing the package | Search for external usage or entrypoints outside this repo |

---

## Redundant / Duplicate Logic

- **Bitmap/Logo Encoding/Decoding:**
  - logo_codec.py and logo_protocol.py both implement image conversion and packing logic (e.g., RGB565 conversion, chunking).
  - Example: `convert_image_to_rgb565` (logo_protocol.py) vs. `LogoCodec` (logo_codec.py).
  - **Unify plan:** Centralize all image conversion/packing logic in logo_codec.py and remove protocol-specific copies.

- **Protocol Handlers:**
  - Two protocol handlers: uv5rm_protocol.py (clone/memory) and logo_protocol.py (logo upload).
  - Both have similar frame-building, CRC, and chunking logic.
  - **Unify plan:** Abstract common frame/chunk/CRC logic into a shared utility module.

---

## Legacy / Obsolete Protocols or Processes

- **Logo Protocol (logo_protocol.py):**
  - Implements a full protocol for logo upload (UV-17Pro/UV-5RM).
  - Only used in boot_logo.py (as `protocol_upload_logo`).
  - **Evidence of legacy:** Not referenced in CLI, Streamlit, or core flows. CLI/Streamlit use actions.py and results.py for all user-facing operations.
  - **Currently active:** uv5rm_protocol.py and uv5rm_transport.py are used for all main flows.
  - **Migration/removal plan:** If boot_logo.py is not used in any runtime path, remove logo_protocol.py and its references.

---

## Code Smells / Maintainability Risks

- **Redundant image conversion logic** (see above).
- **Unused protocol classes/functions** (see above).
- **Potential layering violation:** Protocols re-exported in __init__.py but not used by main flows.
- **No clear deprecation warnings** for legacy protocol code.
- **Possible dead code in boot_logo.py** (acts as a wrapper for legacy protocol).

---

## Recommended Next Steps (Prioritized)

1. **Delete now:**
   - Remove `LogoUploader`, `upload_logo`, and related unused functions in logo_protocol.py if not used dynamically.
   - Remove boot_logo.py if not referenced by any runtime path.

2. **Unify image conversion logic:**
   - Refactor all image packing/conversion to use logo_codec.py only.

3. **Deprecate legacy protocol:**
   - Add warnings to logo_protocol.py and boot_logo.py if kept for reference.

4. **Manual verification:**
   - Confirm no dynamic imports or external usage of logo_protocol.py/boot_logo.py.

---

## Verification Checklist

- **Search for dynamic imports:**
  - `grep -r "importlib" src/baofeng_logo_flasher/`
  - `grep -r "boot_logo" src/baofeng_logo_flasher/`
  - `grep -r "logo_protocol" src/baofeng_logo_flasher/`

- **Test CLI and Streamlit flows:**
  - Run all CLI commands and Streamlit UI; verify no breakage after removal.
  - Confirm logo upload still works via main flows.

- **Check for external usage:**
  - Search for any scripts or documentation referencing `LogoUploader` or `upload_logo`.

- **Good outcome:**
  - No errors or missing features in CLI/UI.
  - No import errors after code removal.
  - All image conversion/packing handled by logo_codec.py.

---

**End of Audit Report.**
